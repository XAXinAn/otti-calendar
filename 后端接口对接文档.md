# OttiCalendar 后端接口对接文档

## 1. 基础信息
*   **开发环境 Base URL**: `http://192.168.43.227:8080`
*   **生产环境 Base URL**: `待定`
*   **接口前缀**: `/api` (由后端 `context-path` 统一配置)
*   **认证方式**: 采用 **JWT (JSON Web Token)**。除登录/注册接口外，所有请求需在 Header 中携带：
    `Authorization: Bearer {your_token}`

---

## 2. 身份认证模块 (Auth)

### 2.1 手机号密码登录
*   **URL**: `POST /api/auth/login`
*   **请求体**:
```json
{
  "phone": "13800138000",
  "password": "your_password"
}
```
*   **成功响应 (200)**:
```json
{
  "code": 200,
  "message": "登录成功",
  "data": {
    "userId": "user_123",
    "token": "JWT_TOKEN_STRING",
    "refreshToken": "REFRESH_TOKEN_STRING",
    "userInfo": {
      "userId": "user_123",
      "username": "SpeedUser",
      "phone": "13800138000",
      "avatar": "http://...",
      "role": "user"
    }
  }
}
```

### 2.2 手机号注册
*   **URL**: `POST /api/auth/register`
*   **请求体**:
```json
{
  "phone": "13800138000",
  "password": "your_password"
}
```
*   **成功响应 (200)**:
```json
{
  "code": 200,
  "message": "注册成功",
  "data": null
}
```

---

## 3. 日程管理模块 (Schedule)

### 3.1 创建日程
*   **URL**: `POST /api/schedules`
*   **请求体**:
```json
{
  "title": "项目复盘会议",
  "startTime": "2024-08-21T15:00:00.000",
  "endTime": null,
  "location": "301会议室",
  "category": "工作", 
  "isAiGenerated": false
}
```
*   **分类枚举**: `工作`, `学习`, `个人`, `生活`, `健康`, `运动`, `社交`, `家庭`, `差旅`, `其他`

### 3.2 获取某日日程列表
*   **URL**: `GET /api/schedules`
*   **参数**: `date=2024-08-21` (格式: YYYY-MM-DD)
*   **响应 (200)**:
```json
[
  {
    "id": "db_id_1",
    "title": "项目复盘会议",
    "startTime": "2024-08-21T15:00:00.000",
    "endTime": null,
    "location": "301会议室",
    "category": "工作",
    "isAiGenerated": false
  }
]
```

### 3.3 删除日程
*   **URL**: `DELETE /api/schedules/{id}`

---

## 4. AI 与多模态模块 (AI & OCR)

### 4.1 语音识别接口 (服务端识别模式)
*   **URL**: `POST /api/upload-voice`
*   **Content-Type**: `multipart/form-data`
*   **参数**: `file` (二进制音频文件, .m4a 格式)
*   **响应**:
```json
{
  "text": "今天下午三点开会"
}
```

### 4.2 OCR 文本智能解析 (LLM)
*   **URL**: `POST /api/v1/ai/parse-text`
*   **说明**: 将前端 OCR 提取的乱序文字发送给后端，由后端调用 LLM (如 GPT/文心一言) 解析为结构化日程。
*   **请求体**:
```json
{
  "text": "原始OCR识别出的杂乱文字内容",
  "currentTime": "2024-08-21T10:00:00"
}
```
*   **期望返回**: 结构化的 Schedule 对象。

---

## 5. 错误码规约
*   `200`: 请求成功。
*   `400`: 参数格式错误。
*   `401`: Token 失效或缺失。
*   `500`: 服务器内部错误。
